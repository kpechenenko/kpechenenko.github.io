<!DOCTYPE html>
<html lang="ru"
  dir="ltr">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">



<link rel="icon" type="image/ico" href="http://localhost:1313//favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313//favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="http://localhost:1313//android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313//apple-touch-icon.png">

<meta name="description" content=""/>



<title>
    
    Разбор задачи с собеседования на должность middle Go разработчика | Константин Печененко
    
</title>

<link rel="canonical" href="http://localhost:1313/posts/unusual_go_interview_task/"/>

<meta property="og:url" content="http://localhost:1313/posts/unusual_go_interview_task/">
  <meta property="og:site_name" content="Константин Печененко">
  <meta property="og:title" content="Разбор задачи с собеседования на должность middle Go разработчика">
  <meta property="og:description" content="Предыстория # Смотрел запись собеседования на должность middle Go разработчика в российский бигтех на youtube.com и увидел нетипичную задачу. Решил расписать один из вариантов её решения.
Для понимания того, что будет происходить далее, вы должны быть знакомы с основами языка программирования Go.
Самый простой способ пощупать Go – это пройти интерактивный Go tour от создателей языка.
Условие задачи # Дан код:
package main import ( &#34;time&#34; &#34;fmt&#34; ) func printNumber(num int) { fmt.Printf(&#34;Process %d\n&#34;, num) time.Sleep(time.Second) } func main() { // ... } Необходимо:">
  <meta property="og:locale" content="ru">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-14T03:50:13+07:00">
    <meta property="article:modified_time" content="2025-02-14T03:50:13+07:00">













<link rel="stylesheet" href="/assets/combined.min.32c4505ff6f37c4a072861f2cbad7347d8e8e8c8f60e01107b50d77c8c29f9f6.css" media="all">





</head>







<body class="dark">

  <div class="content">
    <header>
      

<div class="header">

    

    <h1 class="header-title">
        <a href="http://localhost:1313/">Константин Печененко</a>
    </h1>

    <div class="flex">
        

        
        
      
        
        
        <p class="small">
            <a href="/" >
                главная
            </a>
        </p>
        
      
        
        
        <p class="small">
            <a href="/posts" >
                посты
            </a>
        </p>
        
      
        
        
        <p class="small">
            <a href="/about" >
                обо мне
            </a>
        </p>
        
        
    </div>

    

</div>

    </header>

    <main class="main">
      





<div >

  <div class="single-intro-container">

    

    <h1 class="single-title">Разбор задачи с собеседования на должность middle Go разработчика</h1>
    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2025-02-14T03:50:13&#43;07:00">14.02.2025</time>
      

      
    </p>

  </div>

  

  

  

  

  <div class="single-content">
    <h2 class="heading" id="предыстория">
  Предыстория
  <a class="anchor" href="#%d0%bf%d1%80%d0%b5%d0%b4%d1%8b%d1%81%d1%82%d0%be%d1%80%d0%b8%d1%8f">#</a>
</h2>
<p>Смотрел запись собеседования на должность middle Go разработчика в российский бигтех на youtube.com и увидел нетипичную задачу. Решил расписать один из вариантов её решения.</p>
<p>Для понимания того, что будет происходить далее, вы должны быть знакомы с основами языка программирования Go.<br>
Самый простой способ пощупать Go &ndash; это пройти интерактивный <a href="https://go.dev/tour/list">Go tour</a> от создателей языка.</p>
<h2 class="heading" id="условие-задачи">
  Условие задачи
  <a class="anchor" href="#%d1%83%d1%81%d0%bb%d0%be%d0%b2%d0%b8%d0%b5-%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8">#</a>
</h2>
<p>Дан код:</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fe8019">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#b8bb26">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#b8bb26">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">printNumber</span>(num <span style="color:#fabd2f">int</span>) {
</span></span><span style="display:flex;"><span>	fmt.<span style="color:#fabd2f">Printf</span>(<span style="color:#b8bb26">&#34;Process %d\n&#34;</span>, num)
</span></span><span style="display:flex;"><span>	time.<span style="color:#fabd2f">Sleep</span>(time.Second)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#928374;font-style:italic">// ...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Необходимо:</p>
<ol>
<li>Последовательно напечатать числа от 1 до 10, используя функцию <code>printNumber</code>. Код функции <code>printNumber</code> изменять нельзя.</li>
<li>Распараллелить печать чисел от 1 до 10. Порядок не важен. Печатать при помощи функции <code>printNumber</code>. Код функции <code>printNumber</code> изменять нельзя.</li>
<li>Напечатать числа от 1 до 10 таким образом, чтобы за раз выводилось по 5 чисел. Порядок не важен. Печатать при помощи функции <code>printNumber</code>. Код функции <code>printNumber</code> изменять нельзя.</li>
</ol>
<h2 class="heading" id="решение-задачи-1">
  Решение задачи 1
  <a class="anchor" href="#%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8-1">#</a>
</h2>
<p>Проходимся в цикле от 1 до 10 и выводим числа, ничего сверхъестественного :)</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fe8019">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">printNumber</span>(num <span style="color:#fabd2f">int</span>) {
</span></span><span style="display:flex;"><span>	fmt.<span style="color:#fabd2f">Printf</span>(<span style="color:#b8bb26">&#34;Process %d\n&#34;</span>, num)
</span></span><span style="display:flex;"><span>	time.<span style="color:#fabd2f">Sleep</span>(time.Second)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">for</span> i <span style="color:#fe8019">:=</span> <span style="color:#d3869b">1</span>; i <span style="color:#fe8019">&lt;=</span> <span style="color:#d3869b">10</span>; i<span style="color:#fe8019">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#fabd2f">printNumber</span>(i)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 class="heading" id="решение-задачи-2">
  Решение задачи 2
  <a class="anchor" href="#%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8-2">#</a>
</h2>
<p>Идея решения: выполнить <code>printNumber</code> для каждого числа в отдельной горутине. В основной горутине дождаться выполнения запущенных горутин.<br>
Ожидать можно по разному (используя счетчики, подсчет значений из канала и прочие извращения), но самым простым вариантом будет использование структруы <code>sync.Mutex</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fe8019">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">printNumber</span>(num <span style="color:#fabd2f">int</span>) {
</span></span><span style="display:flex;"><span>	fmt.<span style="color:#fabd2f">Printf</span>(<span style="color:#b8bb26">&#34;Process %d\n&#34;</span>, num)
</span></span><span style="display:flex;"><span>	time.<span style="color:#fabd2f">Sleep</span>(time.Second)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">main</span>() {
</span></span><span style="display:flex;"><span>	nums <span style="color:#fe8019">:=</span> <span style="color:#fabd2f">make</span>([]<span style="color:#fabd2f">int</span>, <span style="color:#d3869b">0</span>, <span style="color:#d3869b">10</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">for</span> i <span style="color:#fe8019">:=</span> <span style="color:#d3869b">1</span>; i <span style="color:#fe8019">&lt;=</span> <span style="color:#d3869b">10</span>; i<span style="color:#fe8019">++</span> {
</span></span><span style="display:flex;"><span>		nums = <span style="color:#fabd2f">append</span>(nums, i)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#fabd2f">printNumsParallel</span>(nums)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">printNumsParallel</span>(numbers []<span style="color:#fabd2f">int</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">var</span> wg sync.WaitGroup
</span></span><span style="display:flex;"><span>	wg.<span style="color:#fabd2f">Add</span>(<span style="color:#fabd2f">len</span>(numbers)) <span style="color:#928374;font-style:italic">// 1</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">for</span> _, num <span style="color:#fe8019">:=</span> <span style="color:#fe8019">range</span> numbers {
</span></span><span style="display:flex;"><span>		<span style="color:#928374;font-style:italic">// запуск горутин для печати</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fe8019">go</span> <span style="color:#fe8019">func</span>() {
</span></span><span style="display:flex;"><span>			<span style="color:#fe8019">defer</span> wg.<span style="color:#fabd2f">Done</span>()  <span style="color:#928374;font-style:italic">// 2</span>
</span></span><span style="display:flex;"><span>			<span style="color:#fabd2f">printNumber</span>(num) <span style="color:#928374;font-style:italic">// 3</span>
</span></span><span style="display:flex;"><span>		}()
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	wg.<span style="color:#fabd2f">Wait</span>() <span style="color:#928374;font-style:italic">// 4</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol>
<li>Увеличиваем счетчик группы ожидания ДО запуска горутины.</li>
<li>Через отложенный вызов вызываем уменьшение счетчик группы ожидания. Такой вызов отработает даже в том случае, если следующий за ним код в анонимной функции вызовет панику.</li>
<li>Печатаем num. Начиная с go 1.21 можно не передавать num в параметрах функции, т.к. на каждой итерации цикла переменная num будет создаваться заново, поэтому у каждой горутины num будет своя и уникальная. Если вас попросят решить эту задачу в go до 1.21, то num нужно будет явно передавать через параметры функции при запуске функции в отдельной горутине. Иначе поведение будет непрогнозируемое, но почти наверное вместо чисел от 1 до 10 вы получите что-то другое, т.к. порядок запуска горутин не определен.</li>
<li>Ожидаем выполнение всех запущенных горутин.</li>
</ol>
<h2 class="heading" id="решение-задачи-3">
  Решение задачи 3
  <a class="anchor" href="#%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b7%d0%b0%d0%b4%d0%b0%d1%87%d0%b8-3">#</a>
</h2>
<p>При решении текущей задачи хотелось бы каким-то образом &ldquo;одновременно&rdquo; запускать выполнение 5 печатающих задач.
Для этих целей подходит паттерн конкурентного программирования worker pool.</p>
<p>Идея:</p>
<ol>
<li>Записать числа для печати (от 1 до 10) в буфферизированный канал с размером буффера, равным количеству выводимых чисел (5). После записи всех числе закрыть канал, чтобы читающие горутины могли остановить свою работу.</li>
<li>Запустить горутины для печати чисел, которые будут вычитывать числа из канала. Количество горутин должно быть равно размеру буффера канала, это позволит создать эффект одновременной печати, который требуется в условиях задачи.</li>
<li>Подождать пока все печатающие числа горутины отработают.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#fe8019">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b8bb26">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">printNumber</span>(num <span style="color:#fabd2f">int</span>) {
</span></span><span style="display:flex;"><span>	fmt.<span style="color:#fabd2f">Printf</span>(<span style="color:#b8bb26">&#34;Process %d\n&#34;</span>, num)
</span></span><span style="display:flex;"><span>	time.<span style="color:#fabd2f">Sleep</span>(time.Second)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">main</span>() {
</span></span><span style="display:flex;"><span>	numbers <span style="color:#fe8019">:=</span> <span style="color:#fabd2f">make</span>([]<span style="color:#fabd2f">int</span>, <span style="color:#d3869b">0</span>, <span style="color:#d3869b">10</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">for</span> i <span style="color:#fe8019">:=</span> <span style="color:#d3869b">1</span>; i <span style="color:#fe8019">&lt;=</span> <span style="color:#d3869b">10</span>; i<span style="color:#fe8019">++</span> {
</span></span><span style="display:flex;"><span>		numbers = <span style="color:#fabd2f">append</span>(numbers, i)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#fabd2f">printNumbersOfKAtTime</span>(numbers, <span style="color:#d3869b">5</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">func</span> <span style="color:#fabd2f">printNumbersOfKAtTime</span>(numbers []<span style="color:#fabd2f">int</span>, k <span style="color:#fabd2f">int</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">var</span> wg sync.WaitGroup
</span></span><span style="display:flex;"><span>	wg.<span style="color:#fabd2f">Add</span>(k)
</span></span><span style="display:flex;"><span>	<span style="color:#928374;font-style:italic">// создание буфферизированного канала для передачи</span>
</span></span><span style="display:flex;"><span>	in <span style="color:#fe8019">:=</span> <span style="color:#fabd2f">make</span>(<span style="color:#fe8019">chan</span> <span style="color:#fabd2f">int</span>, k)
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">for</span> i <span style="color:#fe8019">:=</span> <span style="color:#d3869b">0</span>; i &lt; k; i<span style="color:#fe8019">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#928374;font-style:italic">// запуск печатающих горутин</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fe8019">go</span> <span style="color:#fe8019">func</span>() {
</span></span><span style="display:flex;"><span>			<span style="color:#fe8019">defer</span> wg.<span style="color:#fabd2f">Done</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#928374;font-style:italic">// каждая горутина вычитывает из канала до тез пор, пока он не будет закрыт</span>
</span></span><span style="display:flex;"><span>			<span style="color:#fe8019">for</span> num <span style="color:#fe8019">:=</span> <span style="color:#fe8019">range</span> in {
</span></span><span style="display:flex;"><span>				<span style="color:#fabd2f">printNumber</span>(num)
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}()
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#928374;font-style:italic">// запуск горутины для записи числе в канал, из которого будут читать печатающие горутины.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#928374;font-style:italic">// Её можно не отслеживать в счетчике wg,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#928374;font-style:italic">// т.к. читающие горутины не завершат свою работу до тех пор, пока не отработает эта.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fe8019">go</span> <span style="color:#fe8019">func</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#fe8019">for</span> _, num <span style="color:#fe8019">:=</span> <span style="color:#fe8019">range</span> numbers {
</span></span><span style="display:flex;"><span>			in <span style="color:#fe8019">&lt;-</span> num
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#928374;font-style:italic">// закрываем канал после записи</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fabd2f">close</span>(in)
</span></span><span style="display:flex;"><span>	}()
</span></span><span style="display:flex;"><span>	<span style="color:#928374;font-style:italic">// ожидаем выполнение всех печатающих горутин</span>
</span></span><span style="display:flex;"><span>	wg.<span style="color:#fabd2f">Wait</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 class="heading" id="ссылки-на-дополнительные-материалы">
  Ссылки на дополнительные материалы
  <a class="anchor" href="#%d1%81%d1%81%d1%8b%d0%bb%d0%ba%d0%b8-%d0%bd%d0%b0-%d0%b4%d0%be%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d1%8b%d0%b5-%d0%bc%d0%b0%d1%82%d0%b5%d1%80%d0%b8%d0%b0%d0%bb%d1%8b">#</a>
</h2>
<ul>
<li><a href="https://go.dev/tour/list">Go tour</a></li>
<li><a href="https://gobyexample.com/worker-pools">Worker pool</a></li>
<li><a href="https://gobyexample.com/mutexes">Mutexes</a></li>
<li><a href="https://gobyexample.com/goroutines">Goroutines</a></li>
<li><a href="https://gobyexample.com/channel-buffering">Buffered channel </a></li>
</ul>

    
  </div>

  


  

  
  

  

  

  

</div>


    </main>
  </div>

  <footer>
    

    
    
    
    <p>© Константин Печененко</p>
    


  </footer>

  

</body>

<script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>

<script defer src="/js/copy-code.js"></script>
</html>